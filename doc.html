<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1"/>
    <meta name="description" content="Simba-os : Simba, UAM, IAM, security, access management, owasp, cegeka" />
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/jquery-ui.min.css">
    <script src="javascripts/jquery.js"></script>
    <script src="javascripts/jquery-ui.min.js"></script>
    <title>Simba-os - Documentation</title>
</head>

<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
    <header class="inner">
        <a id="forkme_banner" href="https://github.com/cegeka/simba-os">View on GitHub</a>

        <h1 id="project_title">Simba-os</h1>

        <h2 id="project_tagline"></h2>

        <section id="downloads">
            <a class="zip_download_link" href="https://github.com/cegeka/simba-os/zipball/master">Download this project
                as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/cegeka/simba-os/tarball/master">Download this project
                as a tar.gz file</a>
        </section>
        <section id="links">
            <ul id="nav">
                <li><a href="index.html#">Home</a></li>
                <li><a href="gettingStarted.html">Getting started</a></li>
                <li><a href="ri.html">Tweak your Simba</a></li>
                <li><a class="selected" href="#">Documentation</a></li>
                <li><a href="contribute.html">Contribute</a></li>
            </ul>
        </section>
    </header>
</div>

<div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner">
        <h3>Reference documentation</h3>

        <!-- MAIN CONTENT start -->
        
        <div id="tabs">
            <ul>
                <li><a href="#tabs-1">Services</a></li>
                <li><a href="#tabs-2">Command Chain</a></li>
                <li><a href="#tabs-3">Domain</a></li>
                <li><a href="#tabs-4">Agent model</a></li>
            </ul>
            <div id="tabs-1">
                <p>Simba exposes two services for applications to use for authentication and authorization. These
                services are exposed using <a href="http://thrift.apache.org/">Apache Thrift&trade;</a>.</p>
                <p>By using Thrift we can implement clients in different languages (.NET, php, ...) in an easy way.
                   At this moment only the Java client is ready though.</p>
                <p>Following code can be used to create a Thrift proxy:
                <pre><code>THttpClient tHttpClient = new THttpClient(serviceURL);
TProtocol tProtocol = new TJSONProtocol(tHttpClient);</code></pre></p>

                <h4>Authentication</h4>
                <p>The Authentication service is responsible for checking a request for valid authentication data. The
                   URL for this service is "/authenticationService"</p>

                <p>Following snippet shows how the authentication service can be called using Java:</p>
                <pre><code>AuthenticationFilterService.Client authenticationClient =
    new AuthenticationFilterService.Client(tProtocol);

ActionDescriptor actionDescriptor =
    authenticationClient.processRequest(requestData, "chain-name");</code></pre>

                <p>The authentication service just contains this single method to process a request, returning
                   an ActionDescriptor.</p>

                <h4>Authorization</h4>
                <p>The authorization service is responsible for checking if a user is authorized to access a specific
                   resource. The URL for this service is "/authorizationService"</p>

                <p>Following snippet shows how the authorization service can be called using Java:</p>
                <pre><code>AuthorizationService.Client authorizationClient =
    new AuthorizationService.Client(tProtocol);
PolicyDecision decision =
    authorizationClient.isResourceRuleAllowed(userName, resource, action);
if (!decision.isAllowed()) {
    throw new SecurityException("You are not allowed here !");
}</code></pre>
                <p>The authorization service contains three methods:</p>
                <dl>
                    <dt>PolicyDecision isResourceRuleAllowed(username, resourceName, operation)</dt>
                    <dd>Check if a user is allowed to perform a specified action on the given resource.</dd>
                    <dt>PolicyDecision isURLRuleAllowed(username, url, method)</dt>
                    <dd>Check if a user is allowed to perform a specified action on the given URL.</dd>
                    <dt>PolicyDecision isUserInRole(username, roleName)</dt>
                    <dd>Check if a user is included in the specified role.</dd>
                </dl>
                <p>The returned PolicyDecision contains a boolean value for the decision and a timestamp noting how
                long the decision is valid.</p>
            </div>
            <div id="tabs-2">
                Simba uses a chain of commands to process a request and decide the needed actions.
                <h4>CommandChain API</h4>
                New commands can easily be written to serve your custom needs. Simply extend the Command
                class and plug it into your chain in the correct place.

                <h5>Chain</h5>
                <p>A Chain represents a configured list of Commands that will be executed in order to perform processing
                   on a specified for a specific request.</p>
                <p>Each included Command will be executed in turn, until either one of them returns a 'FINISHED' state,
                   an exception is thrown or the end of the chain has been reached.</p>
                <p><b>Note</b> that Chain itself is a Command. This allows for chains to be easily combined and processed
                    in a hierarchical manner.</p>

                <h5>Command</h5>
                <p>A Command encapsulates a unit of processing work to be performed, whose purpose is to examine and/or
                   modify the state of a request/response.</p>

                <h5>Decision</h5>
                <p>Check for certain conditions to be met.</p>

                <h5>DecisionCommand</h5>
                <p>The DecisionCommand is a Command implementation allowing to execute one of two Commands depending on
                   a Decision.

                <img src="images/simba-command-diagram.png"/>

                <h4>Provided commands</h4>
                <h5>Authentication</h5>
                <h6>CheckAccountBlockedCommand</h6>
                <p>Check if a user account is blocked. A redirect action containing a blocked message is created if
                   it is blocked. This command should be positioned in the chain somewhere after the password check
                   to not provide to much info to possible hackers.</p>

                <h6>CheckHttpRequestMethodCommand</h6>
                <h6>CheckPasswordExpiredCommand</h6>
                <p>Check if the user's password is expired. If this is the case, an action is created to redirect the
                   user to a change password page.</p>

                <h6>CheckUserActiveCommand</h6>
                <p>Check if the user exists in the datastore and if the user is not declared inactive. Creates a
                   redirect action with credential errors if the user isn't active.</p>

                <h6>ExcludeResourceCommand</h6>
                <p>Allows specific resources to be excluded from authentication. This can be used to distinguish
                   between public and private pages in your application. This command should be one of the first in
                   the chain.</p>

                <h6>JaasLoginCommand</h6>
                <p>Performs the actual credential check. The command uses a configured JAAS flow to do this check. If
                   the JAAS login fails, a redirect action containing a credential error is created.</p>

                <h6>ValidateRequestParametersCommand</h6>
                <p>Check if the request contains the correct attributes to perform a login. A redirect action containing
                   credential errors is created if this is not the case.</p>

                <h5>Authorization</h5>
                <h6>URLRuleCheckCommand</h6>
                <p>Check if the user is allowed to access the specific request URL. If this is not the case, a
                   redirect action to an access denied page is created.</p>

                <h5>Session</h5>
                <h6>ChangePasswordCommand</h6>
                <p>Detect request to change a user password. It will try to perform the password change and then
                   create an action to redirect the user to a result page.</p>

                <h6>CheckClientIPCommand</h6>
                <p>Check if the current request for the user origins from the same IP-address as the on that
                   created the session. If this is not the case, a redirect action for the login page is
                   created.</p>

                <h6>CheckSessionCommand</h6>
                <p>Check if the user has a valid session. If there is no session, or if the session is expired,
                    a redirect action for the login page is created.</p>

                <h6>CheckShowChangePasswordCommand</h6>
                <p>Creates an action to redirect the user to a change password page if the request is a request to
                   display this page.</p>

                <h6>CreateCookieForNewSSOTokenCommand</h6>
                <p>In cases where a valid SSO token is provided, but there was not valid cookie sent by the
                   user, this command creates the action to make the cookie.</p>

                <h6>CreateSessionCommand</h6>
                <p>Creates a session for a user if there is none available. It will create an action to create
                    the SSO cookie and an action to redirect the user to the correct URL.</p>

                <h6>LogoutCommand</h6>
                <p>Handles a specific logout request. The command will destroy the user's session and create
                   actions to delete the SSO cookie and redirect the user to the logout page.</p>

                <h6>EnterApplicationCommand</h6>
                <p>This command is normally the last in the chain. If a request gets through all other commands, then
                   this command will simply create the action to allow entering the application.</p>

                <h4>Reference Chain</h4>
                <img src="images/configured-chain.png" width="100%"/>
            </div>
            <div id="tabs-3">
                We've kept the domain model for Simba as simple as possible. Everything in the domain is targeted to
                Users, Roles and Policies.
                <img src="images/simba-class-diagram.png" />
            </div>
            <div id="tabs-4">
				<p><img alt="simba agent model" src="images/agent-model.JPG"></p>
            </div>
        </div>
    </section>
</div>

   <!-- FOOTER  -->
   <div id="footer_wrap" class="outer">
     <footer class="inner">
       <p class="copyright">Simba-os is maintained by <a href="https://github.com/cegeka">cegeka</a>.
	Can't find what you need? Contact us at <a href="mailto:security-competence-center@cegeka.be">security-competence-center@cegeka.be</a></p>
     </footer>
   </div>

<script>
    $("#tabs").tabs();

    // Hover states on the static widgets
    $("#dialog-link, #icons li").hover(
            function () {
                $(this).addClass("ui-state-hover");
            },
            function () {
                $(this).removeClass("ui-state-hover");
            }
    );
</script>
</body>
</html>